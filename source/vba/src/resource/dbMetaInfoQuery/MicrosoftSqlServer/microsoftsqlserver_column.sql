SELECT
    C.TABLE_SCHEMA              AS TABLE_SCHEMA
   ,C.TABLE_NAME                AS TABLE_NAME
   ,EP_TABLE.VALUE              AS TABLE_COMMENT
   ,C.COLUMN_NAME               AS COLUMN_NAME
   ,C.DATA_TYPE                 AS COLUMN_TYPE
   ,CASE
        WHEN UPPER(C.DATA_TYPE) = 'CHAR'            AND C.CHARACTER_MAXIMUM_LENGTH IS NOT NULL THEN C.DATA_TYPE + '(' + REPLACE(CAST(C.CHARACTER_MAXIMUM_LENGTH AS VARCHAR(32)), '-1', 'max') + ')'
        WHEN UPPER(C.DATA_TYPE) = 'VARCHAR'         AND C.CHARACTER_MAXIMUM_LENGTH IS NOT NULL THEN C.DATA_TYPE + '(' + REPLACE(CAST(C.CHARACTER_MAXIMUM_LENGTH AS VARCHAR(32)), '-1', 'max') + ')'
        WHEN UPPER(C.DATA_TYPE) = 'NCHAR'           AND C.CHARACTER_MAXIMUM_LENGTH IS NOT NULL THEN C.DATA_TYPE + '(' + REPLACE(CAST(C.CHARACTER_MAXIMUM_LENGTH AS VARCHAR(32)), '-1', 'max') + ')'
        WHEN UPPER(C.DATA_TYPE) = 'NVARCHAR'        AND C.CHARACTER_MAXIMUM_LENGTH IS NOT NULL THEN C.DATA_TYPE + '(' + REPLACE(CAST(C.CHARACTER_MAXIMUM_LENGTH AS VARCHAR(32)), '-1', 'max') + ')'
        WHEN UPPER(C.DATA_TYPE) = 'DECIMAL'         AND C.NUMERIC_PRECISION IS NOT NULL AND C.NUMERIC_SCALE IS NOT NULL THEN C.DATA_TYPE + '(' + CAST(C.NUMERIC_PRECISION AS VARCHAR(32)) + ', ' + CAST(C.NUMERIC_SCALE AS VARCHAR(32)) + ')'
        WHEN UPPER(C.DATA_TYPE) = 'DECIMAL'         AND C.NUMERIC_PRECISION IS NOT NULL AND C.NUMERIC_SCALE IS NULL     THEN C.DATA_TYPE + '(' + CAST(C.NUMERIC_PRECISION AS VARCHAR(32)) + ')'
        WHEN UPPER(C.DATA_TYPE) = 'NUMERIC'         AND C.NUMERIC_PRECISION IS NOT NULL AND C.NUMERIC_SCALE IS NOT NULL THEN C.DATA_TYPE + '(' + CAST(C.NUMERIC_PRECISION AS VARCHAR(32)) + ', ' + CAST(C.NUMERIC_SCALE AS VARCHAR(32)) + ')'
        WHEN UPPER(C.DATA_TYPE) = 'NUMERIC'         AND C.NUMERIC_PRECISION IS NOT NULL AND C.NUMERIC_SCALE IS NULL     THEN C.DATA_TYPE + '(' + CAST(C.NUMERIC_PRECISION AS VARCHAR(32)) + ')'
        WHEN UPPER(C.DATA_TYPE) = 'FLOAT'           AND C.NUMERIC_PRECISION IS NOT NULL                                 THEN C.DATA_TYPE + '(' + CAST(C.NUMERIC_PRECISION AS VARCHAR(32)) + ')'
        WHEN UPPER(C.DATA_TYPE) = 'REAL'            AND C.NUMERIC_PRECISION IS NOT NULL                                 THEN C.DATA_TYPE + '(' + CAST(C.NUMERIC_PRECISION AS VARCHAR(32)) + ')'
        WHEN UPPER(C.DATA_TYPE) = 'DATETIME2'       AND C.DATETIME_PRECISION IS NOT NULL THEN C.DATA_TYPE + '(' + CAST(C.DATETIME_PRECISION AS VARCHAR(32)) + ')'
        WHEN UPPER(C.DATA_TYPE) = 'DATETIMEOFFSET'  AND C.DATETIME_PRECISION IS NOT NULL THEN C.DATA_TYPE + '(' + CAST(C.DATETIME_PRECISION AS VARCHAR(32)) + ')'
        WHEN UPPER(C.DATA_TYPE) = 'TIME'            AND C.DATETIME_PRECISION IS NOT NULL THEN C.DATA_TYPE + '(' + CAST(C.DATETIME_PRECISION AS VARCHAR(32)) + ')'
        WHEN UPPER(C.DATA_TYPE) = 'BINARY'          AND C.CHARACTER_MAXIMUM_LENGTH IS NOT NULL THEN C.DATA_TYPE + '(' + REPLACE(CAST(C.CHARACTER_MAXIMUM_LENGTH AS VARCHAR(32)), '-1', 'max') + ')'
        WHEN UPPER(C.DATA_TYPE) = 'VARBINARY'       AND C.CHARACTER_MAXIMUM_LENGTH IS NOT NULL THEN C.DATA_TYPE + '(' + REPLACE(CAST(C.CHARACTER_MAXIMUM_LENGTH AS VARCHAR(32)), '-1', 'max') + ')'
        ELSE C.DATA_TYPE
    END                         AS COLUMN_TYPE_FORMAL
   ,CASE C.IS_NULLABLE
        WHEN 'YES' THEN 'Y'
        ELSE 'N'
    END                         AS IS_NULL
   ,C.COLUMN_DEFAULT            AS DEFAULT_VALUE
   ,C.CHARACTER_MAXIMUM_LENGTH  AS CHAR_LENGTH
   ,C.NUMERIC_PRECISION         AS DATA_PRECISION
   ,C.NUMERIC_SCALE             AS DATA_SCALE
   ,C.DATETIME_PRECISION        AS DATETIME_PRECISION
   ,C.NUMERIC_PRECISION         AS INTERVAL_PRECISION
   ,EP_COLUMN.VALUE             AS COLUMN_COMMENT
FROM
    information_schema.TABLES T
        INNER JOIN information_schema.COLUMNS C ON T.TABLE_SCHEMA = C.TABLE_SCHEMA
                                               AND T.TABLE_NAME   = C.TABLE_NAME
        INNER JOIN sys.schemas SS ON SS.NAME = T.TABLE_SCHEMA
        INNER JOIN sys.tables  ST ON SS.SCHEMA_ID = ST.SCHEMA_ID
                                 AND T.TABLE_NAME = ST.NAME
        INNER JOIN sys.columns SC ON ST.OBJECT_ID  = SC.OBJECT_ID
                                 AND C.COLUMN_NAME = SC.NAME
        LEFT JOIN sys.extended_properties EP_TABLE  ON ST.OBJECT_ID = EP_TABLE.MAJOR_ID
                                                   AND EP_TABLE.MINOR_ID  = 0
                                                   AND EP_TABLE.CLASS_DESC = 'OBJECT_OR_COLUMN'
                                                   AND UPPER(EP_TABLE.NAME) = 'COMMENT_DESCRIPTION'
        LEFT JOIN sys.extended_properties EP_COLUMN ON ST.OBJECT_ID = EP_COLUMN.MAJOR_ID
                                                   AND SC.COLUMN_ID = EP_COLUMN.MINOR_ID
                                                   AND EP_COLUMN.CLASS_DESC = 'OBJECT_OR_COLUMN'
                                                   AND UPPER(EP_COLUMN.NAME) = 'COMMENT_DESCRIPTION'
WHERE
${condition}
ORDER BY
    C.TABLE_SCHEMA
   ,C.TABLE_NAME
   ,C.ORDINAL_POSITION